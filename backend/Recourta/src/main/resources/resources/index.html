<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>파일 보내기 예제</title>
</head>
<body>
<form enctype="multipart/form-data" id="form">
    <input id="Name" name="name" value="최싸피"/>
    <input id="Email" name="email" value="ssafy5@ssafy.com"/>
    <input id="Password" type="password" name="password" />
    <input id="IsStudent" type="number" name="isStudent" />
    <input type="file" id="file" name="userImg"/>
    <button type="button" id="Button">전송</button>
</form>

<script>
    const ButtonElement = document.querySelector('#Button');

    ButtonElement.addEventListener('click', () => {
        let data = {
            name: $('#Name').val(),
            email: $('#Email').val(),
            password: $('#Password').val(),
            isStudent: $('#IsStudent').val()
        };
        console.log("data: " + data);
        console.log("typeof(data): " + typeof(data));
        let form =$('#form')[0];
        let formData = new FormData(form);
        formData.append('userImg', $('#file'));
        console.log($('#file'));
        console.log(new Blob([JSON.stringify(data)]));
        formData.append('request', new Blob([JSON.stringify(data)] , {type: 'application/json'}));

        console.log(formData);
        $.ajax({
            type: 'POST',
            url: '/recourta/user',
            processData: false,
            contentType:false,
            data: formData,
        }).done(function() {
            alert('글이 등록되었습니다.');
        }).fail(function (error) {
            alert(JSON.stringify(error));
        });
    });

</script>
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
</body>
</html>